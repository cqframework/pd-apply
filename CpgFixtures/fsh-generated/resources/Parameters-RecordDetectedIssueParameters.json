{
  "resourceType": "Parameters",
  "id": "RecordDetectedIssueParameters",
  "parameter": [
    {
      "name": "subject",
      "valueString": "Patient/Patient1"
    },
    {
      "name": "practitioner",
      "valueString": "Practitioner/Practitioner1"
    },
    {
      "name": "encounter",
      "valueString": "Encounter/Encounter1"
    },
    {
      "name": "activityDefinition",
      "resource": {
        "resourceType": "ActivityDefinition",
        "id": "RecordDetectedIssueActivity",
        "meta": {
          "profile": [
            "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recorddetectedissueactivity"
          ]
        },
        "kind": "Task",
        "profile": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recorddetectedissuetask",
        "intent": "proposal",
        "extension": [
          {
            "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability",
            "valueCode": "publishable"
          },
          {
            "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel",
            "valueCode": "structured"
          }
        ],
        "url": "http://example.com/ActivityDefinition/RecordDetectedIssueActivity",
        "name": "RecordDetectedIssueActivity",
        "title": "ActivityDefinition RecordDetectedIssueActivity",
        "status": "draft",
        "experimental": true,
        "publisher": "Example",
        "jurisdiction": [
          {
            "coding": [
              {
                "code": "001",
                "system": "http://unstats.un.org/unsd/methods/m49/m49.htm",
                "display": "World"
              }
            ]
          }
        ],
        "version": "0.1.0",
        "description": "Example Activity Definition for a recommendation to record a detected issue",
        "code": {
          "coding": [
            {
              "code": "record-detected-issue",
              "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type",
              "display": "Record a detected issue"
            }
          ]
        },
        "doNotPerform": false,
        "dynamicValue": [
          {
            "path": "input[0].type",
            "expression": {
              "language": "text/fhirpath",
              "expression": "code"
            }
          },
          {
            "path": "input[0].value",
            "expression": {
              "language": "text/fhirpath",
              "expression": "DetectedIssue { id: 'detected-issue', status: 'final', code: \"Time-related Detected Issue\", severity: 'high', patient: Patient, identified: Today() }"
            }
          }
        ]
      }
    },
    {
      "name": "data",
      "resource": {
        "resourceType": "Bundle",
        "id": "PatientTestBundle1",
        "type": "collection",
        "entry": [
          {
            "resource": {
              "resourceType": "Patient",
              "id": "Patient1"
            }
          },
          {
            "resource": {
              "resourceType": "Encounter",
              "id": "Encounter1",
              "status": "in-progress",
              "class": {
                "code": "AMB",
                "system": "http://terminology.hl7.org/CodeSystem/v3-ActCode"
              },
              "subject": {
                "reference": "Patient/Patient1"
              },
              "participant": [
                {
                  "individual": {
                    "reference": "Practitioner/Practitioner1"
                  }
                }
              ]
            }
          },
          {
            "resource": {
              "resourceType": "Practitioner",
              "id": "Practitioner1"
            }
          },
          {
            "resource": {
              "resourceType": "MedicationRequest",
              "id": "PastMedicationRequest",
              "status": "active",
              "intent": "order",
              "authoredOn": "2023-01-01",
              "medicationCodeableConcept": {
                "text": "Some medication"
              },
              "subject": {
                "reference": "Patient/Patient1"
              }
            }
          }
        ]
      }
    }
  ]
}
