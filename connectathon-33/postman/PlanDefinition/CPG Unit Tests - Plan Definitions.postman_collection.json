{
	"info": {
		"_postman_id": "20ea19e4-0563-40c7-8bb9-b24f26ecf8ec",
		"name": "CPG Unit Tests - Plan Definitions",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "PlanDefinition - CKDEducation",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"CKDEducationExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/CKDEducationRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"CKDEducationRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/CKDEducationPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"CKD Patient Education\",",
							"            \"description\": \"Provide verbal and written education on disease state at time of CKD diagnosis\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"provide-counseling\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Provide Counseling\"",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"CKDEducationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"CKDEducationPlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/CKDEducationPlan\",\n                \"name\": \"CKDEducationPlan\",\n                \"title\": \"PlanDefinition CKDEducationPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"description\": \"Plan definition to provide education to a patient with newly diagnosed chronic kidney disease\",\n                \"action\": [\n                    {\n                        \"title\": \"CKD Patient Education\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provide-counseling\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Provide Counseling\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"description\": \"Provide verbal and written education on disease state at time of CKD diagnosis\"\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - ReportHeightWeight",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"ReportHeightWeightExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/ReportHeightWeightRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"ReportHeightWeightRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/ReportWeightHeightPlan|0.1.0\"",
							"        ],",
							"        \"extension\": [",
							"          {",
							"            \"url\": \"http://hl7.org/fhir/StructureDefinition/resource-pertainsToGoal\",",
							"            \"valueReference\": {",
							"              \"reference\": \"Goal/WeightTargetGoal\"",
							"            }",
							"          }",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Report Weight\",",
							"            \"description\": \"Report weight metric upon admission\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"diagnostic-testing\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Conduct Diagnostic Tests\"",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          },",
							"          {",
							"            \"title\": \"Report Height\",",
							"            \"description\": \"Report height metric upon admission\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"diagnostic-testing\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Conduct Diagnostic Tests\"",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"resource\": {",
							"        \"resourceType\": \"Goal\",",
							"        \"id\": \"WeightTargetGoal\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"lifecycleStatus\": \"planned\",",
							"        \"description\": {",
							"          \"text\": \"Weight target\"",
							"        }",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"ReportHeightWeightParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"ReportWeightHeightPlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/ReportWeightHeightPlan\",\n                \"name\": \"ReportWeightHeightPlan\",\n                \"title\": \"PlanDefinition ReportWeightHeightPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"description\": \"Plan to report weight and height of patient upon admission\",\n                \"goal\": [\n                    {\n                        \"description\": {\n                            \"text\": \"Weight target\"\n                        }\n                    }\n                ],\n                \"action\": [\n                    {\n                        \"title\": \"Report Weight\",\n                        \"description\": \"Report weight metric upon admission\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"diagnostic-testing\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Conduct Diagnostic Tests\"\n                                    }\n                                ]\n                            }\n                        ]\n                    },\n                    {\n                        \"title\": \"Report Height\",\n                        \"description\": \"Report height metric upon admission\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"diagnostic-testing\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Conduct Diagnostic Tests\"\n                                    }\n                                ]\n                            }\n                        ]\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - DischargeFollowUpPlan",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"DischargeFollowUpExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/DischargeRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"DischargeRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/DischargeFollowUpPlan|0.1.0\"",
							"        ],",
							"        \"extension\": [",
							"          {",
							"            \"url\": \"http://hl7.org/fhir/StructureDefinition/resource-pertainsToGoal\",",
							"            \"valueReference\": {",
							"              \"reference\": \"Goal/PatientMonitoringGoal\"",
							"            }",
							"          }",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Monitor patient\",",
							"            \"description\": \"Monitor patient post discharge\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"monitor-and-follow-up-of-patient\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Monitor and Follow-up of Patient\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"action\": [",
							"              {",
							"                \"title\": \"Case management or referral\",",
							"                \"code\": [",
							"                  {",
							"                    \"coding\": [",
							"                      {",
							"                        \"code\": \"discharge-referral-of-patient\",",
							"                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                        \"display\": \"Discharge/Referral of Patient\"",
							"                      }",
							"                    ]",
							"                  }",
							"                ]",
							"              },",
							"              {",
							"                \"title\": \"Schedule follow-up visit\",",
							"                \"code\": [",
							"                  {",
							"                    \"coding\": [",
							"                      {",
							"                        \"code\": \"monitor-and-follow-up-of-patient\",",
							"                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                        \"display\": \"Monitor and Follow-up of Patient\"",
							"                      }",
							"                    ]",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"resource\": {",
							"        \"resourceType\": \"Goal\",",
							"        \"id\": \"PatientMonitoringGoal\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"lifecycleStatus\": \"planned\",",
							"        \"description\": {",
							"          \"text\": \"Patient monitoring\"",
							"        }",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"DischargeFollowUpParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"DischargeFollowUpPlan\",\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/DischargeFollowUpPlan\",\n                \"name\": \"DischargeFollowUpPlan\",\n                \"title\": \"PlanDefinition DischargeFollowUpPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"description\": \"Definition of plan to monitor patient following discharge\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"goal\": [\n                    {\n                        \"description\": {\n                            \"text\": \"Patient monitoring\"\n                        }\n                    }\n                ],\n                \"action\": [\n                    {\n                        \"title\": \"Monitor patient\",\n                        \"description\": \"Monitor patient post discharge\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"monitor-and-follow-up-of-patient\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Monitor and Follow-up of Patient\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"action\": [\n                            {\n                                \"title\": \"Case management or referral\",\n                                \"code\": [\n                                    {\n                                        \"coding\": [\n                                            {\n                                                \"code\": \"discharge-referral-of-patient\",\n                                                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                                \"display\": \"Discharge/Referral of Patient\"\n                                            }\n                                        ]\n                                    }\n                                ]\n                            },\n                            {\n                                \"title\": \"Schedule follow-up visit\",\n                                \"code\": [\n                                    {\n                                        \"coding\": [\n                                            {\n                                                \"code\": \"monitor-and-follow-up-of-patient\",\n                                                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                                \"display\": \"Monitor and Follow-up of Patient\"\n                                            }\n                                        ]\n                                    }\n                                ]\n                            }\n                        ]\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - IronDeficiencyTreatmentPlan",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"IronDeficiencyTreatmentExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/IronDeficiencyTreatmentRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"IronDeficiencyTreatmentRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/IronDeficiencyTreatmentPlan|0.1.0\"",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"IronDeficiencyTreatmentParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"IronDeficiencyTreatmentPlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/IronDeficiencyTreatmentPlan\",\n                \"name\": \"IronDeficiencyTreatmentPlan\",\n                \"title\": \"PlanDefinition IronDeficiencyTreatmentPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"description\": \"Definition of a plan to prescribe iron supplement if patient has diagnosis or iron deficiency anemia\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"library\": [\n                    \"http://example.org/Library/IronDeficiencyTreatmentLibrary\"\n                ],\n                \"action\": [\n                    {\n                        \"title\": \"Iron Supplementation\",\n                        \"textEquivalent\": \"Daily elemental iron should be prescribed if diagnosed with iron deficiency anemia\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"dispense-medication\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Dispense Medications\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"condition\": [\n                            {\n                                \"kind\": \"applicability\",\n                                \"expression\": {\n                                    \"language\": \"text/cql-identifier\",\n                                    \"expression\": \"Has Anemia\"\n                                }\n                            }\n                        ]\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - IschemicStroke",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"IschemicStrokeExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/IschemicStrokeRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"IschemicStrokeRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/IschemicStrokePlan|0.1.0\"",
							"        ],",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Ischemic Stroke Treatment\",",
							"            \"description\": \"Recommendation to administer TPA if patient had Ischemic Stroke\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"dispense-medications\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Dispense Medications\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"textEquivalent\": \"Administer TPA intravenously\"",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"IschemicStrokeParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"IschemicStrokePlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/IschemicStrokePlan\",\n                \"name\": \"IschemicStrokePlan\",\n                \"title\": \"PlanDefinition IschemicStrokePlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"description\": \"Definition of a plan to administer TPA if patient had ischemic stroke\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"library\": [\n                    \"http://example.org/Library/IschemicStrokeLibrary\"\n                ],\n                \"action\": [\n                    {\n                        \"title\": \"Ischemic Stroke Treatment\",\n                        \"description\": \"Recommendation to administer TPA if patient had Ischemic Stroke\",\n                        \"textEquivalent\": \"Administer TPA intravenously\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"dispense-medications\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Dispense Medications\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"condition\": [\n                            {\n                                \"kind\": \"applicability\",\n                                \"expression\": {\n                                    \"language\": \"text/cql-identifier\",\n                                    \"expression\": \"Had Ischemic Stroke\"\n                                }\n                            }\n                        ]\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - AnemiaScreening",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"AnemiaScreeningExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/AnemiaScreeningRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"AnemiaScreeningRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/AnemiaScreeningPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Order CBC Lab Panel\",",
							"            \"description\": \"Order CBC Lab Panel to screen for anemia\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"diagnostic-testing\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Conduct Diagnostic Tests\"",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"AnemiaScreeningParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"AnemiaScreeningPlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/AnemiaScreeningPlan\",\n                \"name\": \"AnemiaScreeningPlan\",\n                \"title\": \"PlanDefinition AnemiaScreeningPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"description\": \"Definition of plan to screen for iron defeciency anemia\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"library\": [\n                    \"http://example.org/Library/AnemiaScreeningLibrary\"\n                ],\n                \"action\": [\n                    {\n                        \"title\": \"Order CBC Lab Panel\",\n                        \"description\": \"Order CBC Lab Panel to screen for anemia\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"diagnostic-testing\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Conduct Diagnostic Tests\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"condition\": [\n                            {\n                                \"kind\": \"applicability\",\n                                \"expression\": {\n                                    \"language\": \"text/cql-identifier\",\n                                    \"expression\": \"Needs CBC\"\n                                }\n                            }\n                        ]\n                    },\n                    {\n                        \"title\": \"Order serum ferritin\",\n                        \"description\": \"Order serum ferritin to monitor iron status\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"diagnostic-testing\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Conduct Diagnostic Tests\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"condition\": [\n                            {\n                                \"kind\": \"applicability\",\n                                \"expression\": {\n                                    \"language\": \"text/cql-identifier\",\n                                    \"expression\": \"Needs serum ferritin\"\n                                }\n                            }\n                        ]\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - CKDManagment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"CKDManagementExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/CKDManagementRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"CKDManagementRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/CKDManagementPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"CKD Education\",",
							"            \"description\": \"CKD Education at time of diagnosis\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"provide-counseling\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Provide Counseling\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"resource\": {",
							"              \"reference\": \"RequestGroup/InlineCKDEducationRequestGroup\"",
							"            }",
							"          },",
							"          {",
							"            \"title\": \"Follow Up Plan\",",
							"            \"description\": \"Schedule follow up with nephrologist\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"monitor-and-follow-up-of-patient\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Monitor and Follow-up of Patient\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"resource\": {",
							"              \"reference\": \"RequestGroup/CKDFollowUpRequestGroup\"",
							"            }",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/CKDFollowUpRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"CKDFollowUpRequestGroup\",",
							"        \"intent\": \"option\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/CKDFollowUpPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"CKD Follow Up Plan\",",
							"            \"description\": \"Schedule follow up with a nephrologist at time of CKD diagnosis\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"monitor-and-follow-up-of-patient\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Monitor and Follow-up of Patient\"",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/InlineCKDEducationRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"InlineCKDEducationRequestGroup\",",
							"        \"intent\": \"option\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/CKDEducationPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"CKD Patient Education\",",
							"            \"description\": \"Provide verbal and written education on disease state at time of CKD diagnosis\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"provide-counseling\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Provide Counseling\"",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"CKDManagementParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"CKDManagementPlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/CKDManagementPlan\",\n                \"name\": \"CKDManagementPlan\",\n                \"title\": \"PlanDefinition CKDManagementPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"description\": \"Management strategy for patients with newly diagnosed Chronic Kidney Disease\",\n                \"action\": [\n                    {\n                        \"title\": \"CKD Education\",\n                        \"description\": \"CKD Education at time of diagnosis\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provide-counseling\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Provide Counseling\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"definitionCanonical\": \"http://example.org/PlanDefinition/CKDEducationPlan\"\n                    },\n                    {\n                        \"title\": \"Follow Up Plan\",\n                        \"description\": \"Schedule follow up with nephrologist\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"monitor-and-follow-up-of-patient\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Monitor and Follow-up of Patient\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"definitionCanonical\": \"http://example.org/PlanDefinition/CKDFollowUpPlan\"\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - SendMessage",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"SendMessagePlanExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/SendMessageRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"SendMessageRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/SendMessagePlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Greet the patient\",",
							"            \"description\": \"Send a message with a greeting\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"alerts-reminders-education\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Alerts Reminders Education\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"type\": {",
							"              \"coding\": [",
							"                {",
							"                  \"code\": \"create\",",
							"                  \"system\": \"http://terminology.hl7.org/CodeSystem/action-type\"",
							"                }",
							"              ]",
							"            },",
							"            \"resource\": {",
							"              \"reference\": \"CommunicationRequest/SendMessageRequest\"",
							"            }",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/CommunicationRequest/SendMessageRequest\",",
							"      \"resource\": {",
							"        \"resourceType\": \"CommunicationRequest\",",
							"        \"id\": \"SendMessageRequest\",",
							"        \"meta\": {",
							"          \"profile\": [",
							"            \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationrequest\"",
							"          ]",
							"        },",
							"        \"status\": \"draft\",",
							"        \"doNotPerform\": false,",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"requester\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"payload\": [",
							"          {",
							"            \"contentString\": \"Greeting: Hello! Alice Message: Example Activity Definition for a recommendation to send a message Practitioner: Michael\"",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"SendMessagePlanParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"SendMessagePlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/SendMessagePlan\",\n                \"name\": \"SendMessagePlan\",\n                \"title\": \"PlanDefinition SendMessagePlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"eca-rule\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\"\n                        }\n                    ]\n                },\n                \"description\": \"Definition of plan recommendation to send a message\",\n                \"action\": [\n                    {\n                        \"title\": \"Greet the patient\",\n                        \"type\": {\n                            \"coding\": [\n                                {\n                                    \"code\": \"create\",\n                                    \"system\": \"http://terminology.hl7.org/CodeSystem/action-type\"\n                                }\n                            ]\n                        },\n                        \"description\": \"Send a message with a greeting\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"alerts-reminders-education\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Alerts Reminders Education\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"definitionCanonical\": \"http://example.org/ActivityDefinition/SendMessageActivity\"\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - Registration",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"RegistrationExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/RegistrationRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"RegistrationRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/$cpg-computableplandefinition/RegistrationPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Registration with questionnaire\",",
							"            \"description\": \"Register patient using questionnaire\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"registration\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Registration\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"resource\": {",
							"              \"reference\": \"Questionnaire/RegistrationQuestionnaire\"",
							"            }",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"RegistrationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"RegistrationPlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/$cpg-computableplandefinition/RegistrationPlan\",\n                \"name\": \"RegistrationPlan\",\n                \"title\": \"$cpg-computableplandefinition RegistrationPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"description\": \"Definition of plan to collect information for patient registration\",\n                \"action\": [\n                    {\n                        \"title\": \"Registration with questionnaire\",\n                        \"description\": \"Register patient using questionnaire\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"registration\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Registration\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"definitionCanonical\": \"http://example.org/Questionnaire/RegistrationQuestionnaire\"\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - CkdPathway",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"CkdPathwayExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/CkdPathwayRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"CkdPathwayRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/CkdPathway|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"CKD Management\",",
							"            \"description\": \"Definition of plan for new diagnosis of CKD\",",
							"            \"resource\": {",
							"              \"reference\": \"RequestGroup/InlineCKDManagementRequestGroup\"",
							"            }",
							"          },",
							"          {",
							"            \"title\": \"Greet patient\",",
							"            \"description\": \"Greet patient at time of patient portal sign up\",",
							"            \"resource\": {",
							"              \"reference\": \"RequestGroup/InlineSendMessageRequestGroup\"",
							"            }",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/InlineCKDFollowUpRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"InlineCKDFollowUpRequestGroup\",",
							"        \"intent\": \"option\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/CKDFollowUpPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"CKD Follow Up Plan\",",
							"            \"description\": \"Schedule follow up with a nephrologist at time of CKD diagnosis\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"monitor-and-follow-up-of-patient\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Monitor and Follow-up of Patient\"",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/InlineCkdEducationRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"InlineCkdEducationRequestGroup\",",
							"        \"intent\": \"option\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/CKDEducationPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"CKD Patient Education\",",
							"            \"description\": \"Provide verbal and written education on disease state at time of CKD diagnosis\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"provide-counseling\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Provide Counseling\"",
							"                  }",
							"                ]",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/CommunicationRequest/InlineCommunicationRequest\",",
							"      \"resource\": {",
							"        \"resourceType\": \"CommunicationRequest\",",
							"        \"id\": \"InlineCommunicationRequest\",",
							"        \"meta\": {",
							"          \"profile\": [",
							"            \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationrequest\"",
							"          ]",
							"        },",
							"        \"status\": \"draft\",",
							"        \"doNotPerform\": false,",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"requester\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"payload\": [",
							"          {",
							"            \"contentString\": \"Greeting: Hello! Alice Message: Example Activity Definition for a recommendation to send a message Practitioner: Michael\"",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/InlineCKDManagementRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"InlineCKDManagementRequestGroup\",",
							"        \"intent\": \"option\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/CKDManagementPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"CKD Education\",",
							"            \"description\": \"CKD Education at time of diagnosis\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"provide-counseling\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Provide Counseling\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"resource\": {",
							"              \"reference\": \"RequestGroup/InlineCKDEducationRequestGroup\"",
							"            }",
							"          },",
							"          {",
							"            \"title\": \"Follow Up Plan\",",
							"            \"description\": \"Schedule follow up with nephrologist\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"monitor-and-follow-up-of-patient\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Monitor and Follow-up of Patient\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"resource\": {",
							"              \"reference\": \"RequestGroup/InlineCKDFollowUpRequestGroup\"",
							"            }",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/InlineSendMessageRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"InlineSendMessageRequestGroup\",",
							"        \"intent\": \"option\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/SendMessagePlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Greet the patient\",",
							"            \"description\": \"Send a message with a greeting\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"alerts-reminders-education\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Alerts Reminders Education\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"type\": {",
							"              \"coding\": [",
							"                {",
							"                  \"code\": \"create\",",
							"                  \"system\": \"http://terminology.hl7.org/CodeSystem/action-type\"",
							"                }",
							"              ]",
							"            },",
							"            \"resource\": {",
							"              \"reference\": \"CommunicationRequest/InlineCommunicationRequest\"",
							"            }",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"CkdPathwayParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"CkdPathway\",\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/CkdPathway\",\n                \"name\": \"CkdPathway\",\n                \"title\": \"PlanDefinition CkdPathway\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\"\n                        }\n                    ]\n                },\n                \"action\": [\n                    {\n                        \"title\": \"CKD Management\",\n                        \"description\": \"Definition of plan for new diagnosis of CKD\",\n                        \"definitionCanonical\": \"http://example.org/PlanDefinition/CKDManagementPlan\"\n                    },\n                    {\n                        \"title\": \"Greet patient\",\n                        \"description\": \"Greet patient at time of patient portal sign up\",\n                        \"definitionCanonical\": \"http://example.org/PlanDefinition/SendMessagePlan\"\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - NeurologicalAssessment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"NeurologicalAssessmentExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/NeurologicalAssessmentRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"NeurologicalAssessmentRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/NeurologicalAssessmentPlan|0.1.0\"",
							"        ],",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Order neurological exam\",",
							"            \"type\": {",
							"              \"coding\": [",
							"                {",
							"                  \"code\": \"create\",",
							"                  \"system\": \"http://terminology.hl7.org/CodeSystem/action-type\"",
							"                }",
							"              ]",
							"            },",
							"            \"resource\": {",
							"              \"reference\": \"ServiceRequest/InlineServiceRequest\"",
							"            }",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/ServiceRequest/InlineServiceRequest\",",
							"      \"resource\": {",
							"        \"resourceType\": \"ServiceRequest\",",
							"        \"id\": \"InlineServiceRequest\",",
							"        \"meta\": {",
							"          \"profile\": [",
							"            \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-servicerequest\"",
							"          ]",
							"        },",
							"        \"status\": \"draft\",",
							"        \"intent\": \"option\",",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/ActivityDefinition/OrderServiceActivity|0.1.0\"",
							"        ],",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"requester\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"doNotPerform\": false,",
							"        \"code\": {",
							"          \"coding\": [",
							"            {",
							"              \"code\": \"order-service\",",
							"              \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type\",",
							"              \"display\": \"Order a service\"",
							"            }",
							"          ]",
							"        },",
							"        \"occurrencePeriod\": {",
							"          \"start\": \"2023-01-01\"",
							"        }",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"NeurologicalAssessmentParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"NeurologicalAssessmentPlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/NeurologicalAssessmentPlan\",\n                \"name\": \"NeurologicalAssessmentPlan\",\n                \"title\": \"PlanDefinition NeurologicalAssessmentPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"description\": \"Definition of a plan to recommend nuerological assessment\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"library\": [\n                    \"http://example.org/Library/NeurologicalAssessmentLibrary\"\n                ],\n                \"action\": [\n                    {\n                        \"title\": \"Order neurological exam\",\n                        \"dynamicValue\": [\n                            {\n                                \"path\": \"occurrencePeriod.start\",\n                                \"expression\": {\n                                    \"language\": \"text/cql-identifier\",\n                                    \"expression\": \"Timing of Service\"\n                                }\n                            }\n                        ],\n                        \"definitionCanonical\": \"http://example.org/ActivityDefinition/OrderServiceActivity\"\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - DischargeInstructions",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"DischargeInstructionsExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/DischargeInstructionsRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"DischargeInstructionsRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/DischargeInstructionsPlan|0.1.0\"",
							"        ],",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Send message with discharge instructions\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"provide-counseling\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Provide Counseling\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"type\": {",
							"              \"coding\": [",
							"                {",
							"                  \"code\": \"create\",",
							"                  \"system\": \"http://terminology.hl7.org/CodeSystem/action-type\"",
							"                }",
							"              ]",
							"            },",
							"            \"resource\": {",
							"              \"reference\": \"CommunicationRequest/DischargeMessageRequest\"",
							"            }",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/CommunicationRequest/DischargeMessageRequest\",",
							"      \"resource\": {",
							"        \"resourceType\": \"CommunicationRequest\",",
							"        \"id\": \"DischargeMessageRequest\",",
							"        \"meta\": {",
							"          \"profile\": [",
							"            \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationrequest\"",
							"          ]",
							"        },",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"requester\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"doNotPerform\": false,",
							"        \"payload\": [",
							"          {",
							"            \"contentString\": \"Provide patient discharge instructions for Alice\"",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: CKD Education Plan $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"DischargeInstructionsParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"DischargeInstructionsPlan\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/DischargeInstructionsPlan\",\n                \"name\": \"DischargeInstructionsPlan\",\n                \"title\": \"PlanDefinition DischargeInstructionsPlan\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"description\": \"Provide patient discharge instructions\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"action\": [\n                    {\n                        \"title\": \"Send message with discharge instructions\",\n                        \"code\": [\n                            {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provide-counseling\",\n                                        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",\n                                        \"display\": \"Provide Counseling\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"dynamicValue\": [\n                            {\n                                \"path\": \"payload[0].contentString\",\n                                \"expression\": {\n                                    \"language\": \"text/fhirpath\",\n                                    \"expression\": \"description + ' for ' + %subject.name.given.first()\"\n                                }\n                            }\n                        ],\n                        \"definitionCanonical\": \"http://example.org/ActivityDefinition/SendMessageActivity\"\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "PlanDefinition - IschemicStrokePathway",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Bundle\",",
							"  \"id\": \"IschemicStrokePathExpected\",",
							"  \"type\": \"collection\",",
							"  \"entry\": [",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/IschemicStrokePathRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"IschemicStrokePathRequestGroup\",",
							"        \"intent\": \"proposal\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/IschemicStrokePathway|0.1.0\"",
							"        ],",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Generate Report\",",
							"            \"type\": {",
							"              \"coding\": [",
							"                {",
							"                  \"code\": \"create\",",
							"                  \"system\": \"http://terminology.hl7.org/CodeSystem/action-type\"",
							"                }",
							"              ]",
							"            },",
							"            \"resource\": {",
							"              \"reference\": \"Task/GenerateReportRequest\"",
							"            }",
							"          },",
							"          {",
							"            \"title\": \"Ischemic Stroke Plan\",",
							"            \"resource\": {",
							"              \"reference\": \"RequestGroup/IschemicStrokeRequestGroup\"",
							"            },",
							"            \"action\": [",
							"              {",
							"                \"title\": \"Order Medication\",",
							"                \"type\": {",
							"                  \"coding\": [",
							"                    {",
							"                      \"code\": \"create\",",
							"                      \"system\": \"http://terminology.hl7.org/CodeSystem/action-type\"",
							"                    }",
							"                  ]",
							"                },",
							"                \"resource\": {",
							"                  \"reference\": \"MedicationRequest/OrderMedicationRequest\"",
							"                }",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/Task/GenerateReportRequest\",",
							"      \"resource\": {",
							"        \"resourceType\": \"Task\",",
							"        \"id\": \"GenerateReportRequest\",",
							"        \"status\": \"draft\",",
							"        \"intent\": \"option\",",
							"        \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/GenerateReportActivity|0.1.0\",",
							"        \"for\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"requester\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"code\": {",
							"          \"coding\": [",
							"            {",
							"              \"code\": \"generate-report\",",
							"              \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type\",",
							"              \"display\": \"Generate a metric or case report\"",
							"            }",
							"          ]",
							"        },",
							"        \"input\": [",
							"          {",
							"            \"type\": {",
							"              \"coding\": [",
							"                {",
							"                  \"code\": \"generate-report\",",
							"                  \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type\",",
							"                  \"display\": \"Generate a metric or case report\"",
							"                }",
							"              ]",
							"            },",
							"            \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/Measure/activity-example-generatereport\"",
							"          }",
							"        ],",
							"        \"description\": \"Plan to treat patient with ischemic stroke for patient Alice\"",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/RequestGroup/InlineIschemicStrokeRequestGroup\",",
							"      \"resource\": {",
							"        \"resourceType\": \"RequestGroup\",",
							"        \"id\": \"InlineIschemicStrokeRequestGroup\",",
							"        \"intent\": \"option\",",
							"        \"status\": \"draft\",",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/PlanDefinition/IschemicStrokePlan|0.1.0\"",
							"        ],",
							"        \"author\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"action\": [",
							"          {",
							"            \"title\": \"Ischemic Stroke Treatment\",",
							"            \"description\": \"Recommendation to administer TPA if patient had Ischemic Stroke\",",
							"            \"code\": [",
							"              {",
							"                \"coding\": [",
							"                  {",
							"                    \"code\": \"dispense-medications\",",
							"                    \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process\",",
							"                    \"display\": \"Dispense Medications\"",
							"                  }",
							"                ]",
							"              }",
							"            ],",
							"            \"textEquivalent\": \"Administer TPA intravenously\"",
							"          }",
							"        ]",
							"      }",
							"    },",
							"    {",
							"      \"fullUrl\": \"http://apply-processor/MedicationRequest/OrderMedicationRequest\",",
							"      \"resource\": {",
							"        \"resourceType\": \"MedicationRequest\",",
							"        \"id\": \"OrderMedicationRequest\",",
							"        \"status\": \"draft\",",
							"        \"intent\": \"option\",",
							"        \"instantiatesCanonical\": [",
							"          \"http://example.org/ActivityDefinition/OrderMedicationActivity|0.1.0\"",
							"        ],",
							"        \"subject\": {",
							"          \"reference\": \"Patient/Patient1\"",
							"        },",
							"        \"requester\": {",
							"          \"reference\": \"Practitioner/Practitioner1\"",
							"        },",
							"        \"encounter\": {",
							"          \"reference\": \"Encounter/Encounter1\"",
							"        },",
							"        \"doNotPerform\": false,",
							"        \"medicationReference\": {",
							"          \"reference\": \"Medication/CurrentMedication\"",
							"        },",
							"        \"dosageInstruction\": [",
							"          {",
							"            \"sequence\": 1,",
							"            \"text\": \"75mcg daily\",",
							"            \"timing\": {",
							"              \"repeat\": {",
							"                \"frequency\": 1,",
							"                \"period\": 1,",
							"                \"periodUnit\": \"d\"",
							"              }",
							"            },",
							"            \"route\": {",
							"              \"coding\": [",
							"                {",
							"                  \"code\": \"26643006\",",
							"                  \"system\": \"http://snomed.info/sct\",",
							"                  \"display\": \"Oral Route (qualifier value)\"",
							"                }",
							"              ]",
							"            },",
							"            \"doseAndRate\": [",
							"              {",
							"                \"type\": {",
							"                  \"coding\": [",
							"                    {",
							"                      \"code\": \"ordered\",",
							"                      \"system\": \"http://terminology.hl7.org/CodeSystem/dose-rate-type\",",
							"                      \"display\": \"Ordered\"",
							"                    }",
							"                  ]",
							"                },",
							"                \"doseQuantity\": {",
							"                  \"value\": 75,",
							"                  \"code\": \"ug\",",
							"                  \"system\": \"http://unitsofmeasure.org\",",
							"                  \"unit\": \"mcg\"",
							"                }",
							"              }",
							"            ]",
							"          }",
							"        ]",
							"      }",
							"    }",
							"  ]",
							"}",
							"",
							"pm.test(\"PlanDefinition: IschemicStrokePathway $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"IschemicStrokePathwayParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n            \"name\": \"planDefinition\",\n            \"resource\": {\n                \"resourceType\": \"PlanDefinition\",\n                \"id\": \"IschemicStrokePathway\",\n                \"meta\": {\n                    \"profile\": [\n                        \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-computableplandefinition\"\n                    ]\n                },\n                \"extension\": [\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability\",\n                        \"valueCode\": \"publishable\"\n                    },\n                    {\n                        \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeRepresentationLevel\",\n                        \"valueCode\": \"structured\"\n                    }\n                ],\n                \"url\": \"http://example.org/PlanDefinition/IschemicStrokePathway\",\n                \"name\": \"IschemicStrokePathway\",\n                \"title\": \"PlanDefinition IschemicStrokePathway\",\n                \"status\": \"draft\",\n                \"experimental\": true,\n                \"publisher\": \"Example\",\n                \"jurisdiction\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"001\",\n                                \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                                \"display\": \"World\"\n                            }\n                        ]\n                    }\n                ],\n                \"version\": \"0.1.0\",\n                \"description\": \"Plan to treat patient with ischemic stroke\",\n                \"type\": {\n                    \"coding\": [\n                        {\n                            \"code\": \"clinical-protocol\",\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/plan-definition-type\",\n                            \"display\": \"Clinical Protocol\"\n                        }\n                    ]\n                },\n                \"library\": [\n                    \"http://example.org/Library/IschemicStrokeLibrary\"\n                ],\n                \"action\": [\n                    {\n                        \"title\": \"Action based on timing\",\n                        \"condition\": [\n                            {\n                                \"kind\": \"applicability\",\n                                \"expression\": {\n                                    \"language\": \"text/cql-identifier\",\n                                    \"expression\": \"Condition Timing\"\n                                }\n                            }\n                        ]\n                    },\n                    {\n                        \"title\": \"Generate Report\",\n                        \"dynamicValue\": [\n                            {\n                                \"path\": \"description\",\n                                \"expression\": {\n                                    \"language\": \"text/fhirpath\",\n                                    \"expression\": \"description + ' for patient ' + %subject.name.given.first()\"\n                                }\n                            }\n                        ],\n                        \"definitionCanonical\": \"http://example.org/ActivityDefinition/GenerateReportActivity\"\n                    },\n                    {\n                        \"title\": \"Ischemic Stroke Plan\",\n                        \"definitionCanonical\": \"http://example.org/PlanDefinition/IschemicStrokePlan\",\n                        \"action\": [\n                            {\n                                \"title\": \"Order Medication\",\n                                \"condition\": [\n                                    {\n                                        \"kind\": \"applicability\",\n                                        \"expression\": {\n                                            \"language\": \"text/cql-identifier\",\n                                            \"expression\": \"Had Ischemic Stroke\"\n                                        }\n                                    }\n                                ],\n                                \"dynamicValue\": [\n                                    {\n                                        \"path\": \"medicationReference\",\n                                        \"expression\": {\n                                            \"language\": \"text/cql-identifier\",\n                                            \"expression\": \"Medication Reference\"\n                                        }\n                                    }\n                                ],\n                                \"definitionCanonical\": \"http://example.org/ActivityDefinition/OrderMedicationActivity\"\n                            }\n                        ]\n                    }\n                ]\n            }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Medication\",\n                            \"id\": \"CurrentMedication\",\n                            \"status\": \"active\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Medication\",\n                            \"id\": \"PastMedication\",\n                            \"form\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"pill\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Pill\"\n                                    }\n                                ]\n                            },\n                            \"status\": \"inactive\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{cpgServer}}/PlanDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"PlanDefinition",
						"$apply"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"/**",
					" * Delete the id and text as this can vary per request",
					" */",
					"Object.prototype.testPrepare = function testPrepare(resource) {",
					"  delete resource.id;",
					"  delete resource.text;",
					"  resource.entry.forEach(e => {",
					"    delete e.fullUrl;",
					"    delete e.resource.id;",
					"    e.resource.meta ? delete e.resource.meta : null",
					"    if (e.resource.extension) {",
					"      e.resource.extension.forEach(ext => {",
					"        ext.valueReference ? delete ext.valueReference.reference : null",
					"      })",
					"    }",
					"    if (e.resource.action) {",
					"      e.resource.action.forEach(a => {",
					"        a.resource ? delete a.resource.reference : null",
					"        if (a.action) {",
					"          a.action.forEach(subA => {",
					"            subA.resource ? delete subA.resource.reference : null",
					"          })",
					"        }",
					"      })",
					"    }",
					"  })",
					"  return resource;",
					"}",
					"",
					"/**",
					" * Find difference between two objects",
					" * @param  {object} origObj - Source object to compare newObj against",
					" * @param  {object} newObj  - New object with potential changes",
					" * @return {object} differences",
					" */",
					"function difference(origObj, newObj) {",
					"  function changes(newObj, origObj) {",
					"    let arrayIndexCounter = 0",
					"    return _.transform(newObj, function (result, value, key) {",
					"      if (!_.isEqual(value, origObj[key])) {",
					"        let resultKey = _.isArray(origObj) ? arrayIndexCounter++ : key",
					"        result[resultKey] = (_.isObject(value) && _.isObject(origObj[key])) ? changes(value, origObj[key]) : value",
					"      }",
					"    })",
					"  }",
					"  return changes(newObj, origObj)",
					"}",
					"",
					"/**",
					" * Does a deep equal comparison, uses console.log to show diffs if fails.",
					" * ",
					" * @example",
					" * pm.test(\"My test\", function() {",
					" *   _.expectToDeepEqual(pm.response.json(), expected, console);",
					" * });",
					" */",
					"Object.prototype.expectToDeepEqual = (actual, expected, console = console) => {",
					"  try {",
					"    pm.expect(_.testPrepare(actual)).to.deep.equal(_.testPrepare(expected));",
					"  } catch (e) {",
					"    const diff = difference(e.expected, e.actual);",
					"    console.log('difference expected to actual', diff);",
					"    console.log({ actual: e.actual, expected: e.expected});",
					"    e.message = `*** See Console *** ${e.message}`;",
					"    throw new Error(e);",
					"  }",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "cpgServer",
			"value": "http://localhost:9001",
			"type": "string"
		},
		{
			"key": "contentEndpointAddress",
			"value": "http://localhost:8080/fhir",
			"type": "string"
		},
		{
			"key": "contentEndpointType",
			"value": "hl7-fhir-rest",
			"type": "string"
		},
		{
			"key": "terminologyEndpointAddress",
			"value": "http://localhost:8080/fhir",
			"type": "string"
		},
		{
			"key": "terminologyEndpointType",
			"value": "hl7-fhir-rest",
			"type": "string"
		}
	]
}